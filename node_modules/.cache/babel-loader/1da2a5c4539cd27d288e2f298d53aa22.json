{"ast":null,"code":"/**\r\n * Adds loadHtmltemplate command\r\n */\nimport axios from \"axios\";\nimport React from \"react\";\nimport { addWidget, updateWidget, getWidgets, getWidgetData } from \"./actions\";\nimport { loadHtmltemplate } from \"./consts\";\nimport JSZip from \"jszip\";\nimport fs from \"fs\";\nimport path from \"path\";\nfunction importAll(r) {\n  return r.keys().map(r);\n}\nexport default ((editor, config) => {\n  const cm = editor.Commands;\n  cm.add(loadHtmltemplate, e => {\n    const pHtml = e.getModel().get(\"Parser\").parserHtml;\n    // JSX expression in attributes are quoted, so unquote them before passing on\n    let html = pHtml.unquoteJsxExpresionsInAttributes(e.getHtml());\n    config.setHtmlString(html);\n    config.setCssString(e.getCss());\n  });\n  cm.add(\"save-db\", {\n    run: function (editor, sender) {\n      const grapesjsDir = path.join(__dirname, \"grapesjs\");\n      const zipFile = path.join(__dirname, \"grapesjs.zip\");\n      console.log(\"grapesjsDir: \", grapesjsDir, zipFile);\n      const files = importAll(require.context('../', false, /\\.(png|jpe?g|svg)$/));\n      const zip = new JSZip();\n      console.log(files);\n      const reader = new FileReader();\n      files.forEach(file => {\n        const fileContent = reader.readAsText(file);\n        zip.file(file, fileContent);\n      });\n      zip.write(zipFile);\n      sender && sender.set(\"active\");\n      editor.store();\n    }\n  });\n});","map":{"version":3,"names":["axios","React","addWidget","updateWidget","getWidgets","getWidgetData","loadHtmltemplate","JSZip","fs","path","importAll","r","keys","map","editor","config","cm","Commands","add","e","pHtml","getModel","get","parserHtml","html","unquoteJsxExpresionsInAttributes","getHtml","setHtmlString","setCssString","getCss","run","sender","grapesjsDir","join","__dirname","zipFile","console","log","files","require","context","zip","reader","FileReader","forEach","file","fileContent","readAsText","write","set","store"],"sources":["D:/CMK/2023_5/WebsiteBuiderTask/modify/grapesJs/src/Chart/commands.js"],"sourcesContent":["/**\r\n * Adds loadHtmltemplate command\r\n */\r\nimport axios from \"axios\";\r\nimport React from \"react\";\r\nimport { addWidget, updateWidget, getWidgets, getWidgetData } from \"./actions\";\r\nimport { loadHtmltemplate } from \"./consts\";\r\nimport JSZip from \"jszip\";\r\nimport fs from \"fs\";\r\nimport path from \"path\";\r\n\r\nfunction importAll(r) {\r\n  return r.keys().map(r);\r\n}\r\n\r\nexport default (editor, config) => {\r\n  const cm = editor.Commands;\r\n\r\n  cm.add(loadHtmltemplate, (e) => {\r\n    const pHtml = e.getModel().get(\"Parser\").parserHtml;\r\n    // JSX expression in attributes are quoted, so unquote them before passing on\r\n    let html = pHtml.unquoteJsxExpresionsInAttributes(e.getHtml());\r\n    config.setHtmlString(html);\r\n    config.setCssString(e.getCss());\r\n  });\r\n  cm.add(\"save-db\", {\r\n    run: function (editor, sender) {\r\n      const grapesjsDir = path.join(__dirname, \"grapesjs\");\r\n      const zipFile = path.join(__dirname, \"grapesjs.zip\");\r\n\r\n      console.log(\"grapesjsDir: \", grapesjsDir, zipFile);\r\n\r\n      const files = importAll(require.context('../', false, /\\.(png|jpe?g|svg)$/));\r\n\r\n      const zip = new JSZip();\r\n\r\n      console.log(files);\r\n\r\n      const reader = new FileReader();\r\n\r\n      files.forEach((file) => {\r\n        const fileContent = reader.readAsText(file);\r\n        zip.file(file, fileContent);\r\n      });\r\n\r\n      zip.write(zipFile);\r\n      sender && sender.set(\"active\");\r\n      editor.store();\r\n    },\r\n  });\r\n};\r\n"],"mappings":"AAAA;AACA;AACA;AACA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,SAAS,EAAEC,YAAY,EAAEC,UAAU,EAAEC,aAAa,QAAQ,WAAW;AAC9E,SAASC,gBAAgB,QAAQ,UAAU;AAC3C,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,EAAE,MAAM,IAAI;AACnB,OAAOC,IAAI,MAAM,MAAM;AAEvB,SAASC,SAASA,CAACC,CAAC,EAAE;EACpB,OAAOA,CAAC,CAACC,IAAI,CAAC,CAAC,CAACC,GAAG,CAACF,CAAC,CAAC;AACxB;AAEA,gBAAe,CAACG,MAAM,EAAEC,MAAM,KAAK;EACjC,MAAMC,EAAE,GAAGF,MAAM,CAACG,QAAQ;EAE1BD,EAAE,CAACE,GAAG,CAACZ,gBAAgB,EAAGa,CAAC,IAAK;IAC9B,MAAMC,KAAK,GAAGD,CAAC,CAACE,QAAQ,CAAC,CAAC,CAACC,GAAG,CAAC,QAAQ,CAAC,CAACC,UAAU;IACnD;IACA,IAAIC,IAAI,GAAGJ,KAAK,CAACK,gCAAgC,CAACN,CAAC,CAACO,OAAO,CAAC,CAAC,CAAC;IAC9DX,MAAM,CAACY,aAAa,CAACH,IAAI,CAAC;IAC1BT,MAAM,CAACa,YAAY,CAACT,CAAC,CAACU,MAAM,CAAC,CAAC,CAAC;EACjC,CAAC,CAAC;EACFb,EAAE,CAACE,GAAG,CAAC,SAAS,EAAE;IAChBY,GAAG,EAAE,SAAAA,CAAUhB,MAAM,EAAEiB,MAAM,EAAE;MAC7B,MAAMC,WAAW,GAAGvB,IAAI,CAACwB,IAAI,CAACC,SAAS,EAAE,UAAU,CAAC;MACpD,MAAMC,OAAO,GAAG1B,IAAI,CAACwB,IAAI,CAACC,SAAS,EAAE,cAAc,CAAC;MAEpDE,OAAO,CAACC,GAAG,CAAC,eAAe,EAAEL,WAAW,EAAEG,OAAO,CAAC;MAElD,MAAMG,KAAK,GAAG5B,SAAS,CAAC6B,OAAO,CAACC,OAAO,CAAC,KAAK,EAAE,KAAK,EAAE,oBAAoB,CAAC,CAAC;MAE5E,MAAMC,GAAG,GAAG,IAAIlC,KAAK,CAAC,CAAC;MAEvB6B,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;MAElB,MAAMI,MAAM,GAAG,IAAIC,UAAU,CAAC,CAAC;MAE/BL,KAAK,CAACM,OAAO,CAAEC,IAAI,IAAK;QACtB,MAAMC,WAAW,GAAGJ,MAAM,CAACK,UAAU,CAACF,IAAI,CAAC;QAC3CJ,GAAG,CAACI,IAAI,CAACA,IAAI,EAAEC,WAAW,CAAC;MAC7B,CAAC,CAAC;MAEFL,GAAG,CAACO,KAAK,CAACb,OAAO,CAAC;MAClBJ,MAAM,IAAIA,MAAM,CAACkB,GAAG,CAAC,QAAQ,CAAC;MAC9BnC,MAAM,CAACoC,KAAK,CAAC,CAAC;IAChB;EACF,CAAC,CAAC;AACJ,CAAC"},"metadata":{},"sourceType":"module"}